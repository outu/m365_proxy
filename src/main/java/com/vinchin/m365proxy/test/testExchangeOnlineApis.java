package com.vinchin.m365proxy.test;

import com.alibaba.fastjson.JSONObject;
import com.microsoft.graph.requests.GraphServiceClient;
import com.vinchin.m365proxy.apis.ews.FolderRequests;
import com.vinchin.m365proxy.apis.graph.common.ApplicationRequests;
import com.vinchin.m365proxy.apis.graph.common.UserRequests;
import com.vinchin.m365proxy.apis.graph.exchange.MessageRequests;
import microsoft.exchange.webservices.data.core.ExchangeService;
import okhttp3.Request;
import org.dom4j.Document;
import org.dom4j.Element;
import org.dom4j.io.SAXReader;

import java.util.*;

public class testExchangeOnlineApis {
    private static List<Map> soapClient;
    private static ExchangeService ewsClient;
    private static GraphServiceClient<Request> graphClient;

    public static void main(String[] args) throws Exception {
        String mailbox = "yunqi@s22fb.onmicrosoft.com";
        initClient(mailbox);
        System.out.println(getAzureADInfo());
//        ContactRequests contactRequests = new ContactRequests(ewsClient);
//        contactRequests.getContactGroup();
        //System.out.printf("%s", syncGetMessageInfo("AQMkAGI1ZmRjZWUAZC0yZTVlLTQyMzctYTc4Ni0yYjE3NDMxMjdhOGYALgAAAy5x2W1SrcBDvroL1Asx4J8BAKuvciembiNLk9i11WPD-4EAAAIBDAAAAA==","yunqi@s22fb.onmicrosoft.com","",""));
        //<m:Data>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AHYAaQB0AHkAUwB0AHIAZQBhAG0AVABhAHIAZwBlAHQARQBuAHQAaQB0AGkAZQBzACIAOgAiAFsAXAAiADcANgBhADMANABiADQANAAtADcAZAA1ADMALQA0AGUAYgBlAC0AOQA3ADMAYQAtADIANAAxADAANwAwADEAYQAxADcAYQAwAFwAIgBdACIALAAiAFgAcgBtAEEAYwB0AGkAdgBpAHQAeQBTAHQAcgBlAGEAbQBWAGkAcwBpAGIAaQBsAGkAdAB5AEwAZQB2AGUAbAAiADoAIgAxACIALAAiAFgAcgBtAEEAYwB0AGkAdgBpAHQAeQBTAHQAcgBlAGEAbQBNAG8AZABpAGYAaQBlAGQAUAByAG8AcABlAHIAdABpAGUAcwAiADoAIgBbAHsAXAAiAGsAZQB5AFwAIgA6AFwAIgBEAGkAcwBwAGwAYQB5AE4AYQBtAGUAXAAiACwAXAAiAHYAYQBsAHUAZQBcACIAOgB7AFwAIgBrAGUAeQBcACIAOgBcACIAXAAiACwAXAAiAHYAYQBsAHUAZQBcACIAOgBcACIAQQBkAGUAbABlACAAVgBhAG4AYwBlAFwAIgB9AH0ALAB7AFwAIgBrAGUAeQBcACIAOgBcACIARwBpAHYAZQBuAE4AYQBtAGUAXAAiACwAXAAiAHYAYQBsAHUAZQBcACIAOgB7AFwAIgBrAGUAeQBcACIAOgBcACIAXAAiACwAXAAiAHYAYQBsAHUAZQBcACIAOgBcACIAQQBkAGUAbABlAFwAIgB9AH0ALAB7AFwAIgBrAGUAeQBcACIAOgBcACIAUwB1AHIAbgBhAG0AZQBcACIALABcACIAdgBhAGwAdQBlAFwAIgA6AHsAXAAiAGsAZQB5AFwAIgA6AFwAIgBcACIALABcACIAdgBhAGwAdQBlAFwAIgA6AFwAIgBWAGEAbgBjAGUAXAAiAH0AfQAsAHsAXAAiAGsAZQB5AFwAIgA6AFwAIgBUAGkAdABsAGUAXAAiACwAXAAiAHYAYQBsAHUAZQBcACIAOgB7AFwAIgBrAGUAeQBcACIAOgBcACIAXAAiACwAXAAiAHYAYQBsAHUAZQBcACIAOgBcACIAUgBlAHQAYQBpAGwAIABNAGEAbgBhAGcAZQByAFwAIgB9AH0ALAB7AFwAIgBrAGUAeQBcACIAOgBcACIARQBtAGEAaQBsADEATwByAGkAZwBpAG4AYQBsAEQAaQBzAHAAbABhAHkATgBhAG0AZQBcACIALABcACIAdgBhAGwAdQBlAFwAIgA6AHsAXAAiAGsAZQB5AFwAIgA6AFwAIgBcACIALABcACIAdgBhAGwAdQBlAFwAIgA6AFwAIgBBAGQAZQBsAGUAVgBAAHMAMgAyAGYAYgAuAG8AbgBtAGkAYwByAG8AcwBvAGYAdAAuAGMAbwBtAFwAIgB9AH0ALAB7AFwAIgBrAGUAeQBcACIAOgBcACIASQBNAEEAZABkAHIAZQBzAHMAMgBcACIALABcACIAdgBhAGwAdQBlAFwAIgA6AHsAXAAiAGsAZQB5AFwAIgA6AFwAIgBcACIALABcACIAdgBhAGwAdQBlAFwAIgA6AFwAIgBTAEkAUAA6AGEAZABlAGwAZQB2AEAAcwAyADIAZgBiAC4AbwBuAG0AaQBjAHIAbwBzAG8AZgB0AC4AYwBvAG0AXAAiAH0AfQAsAHsAXAAiAGsAZQB5AFwAIgA6AFwAIgBCAHUAcwBpAG4AZQBzAHMAUABoAG8AbgBlAE4AdQBtAGIAZQByAFwAIgAsAFwAIgB2AGEAbAB1AGUAXAAiADoAewBcACIAawBlAHkAXAAiADoAXAAiAFwAIgAsAFwAIgB2AGEAbAB1AGUAXAAiADoAXAAiACsAMQAgADQAMgA1ACAANQA1ADUAIAAwADEAMAA5AFwAIgB9AH0ALAB7AFwAIgBrAGUAeQBcACIAOgBcACIARgBpAGwAZQBBAHMASQBkAFwAIgAsAFwAIgB2AGEAbAB1AGUAXAAiADoAewBcACIAawBlAHkAXAAiADoAXAAiAFwAIgAsAFwAIgB2AGEAbAB1AGUAXAAiADoAXAAiAFwAIgB9AH0ALAB7AFwAIgBrAGUAeQBcACIAOgBcACIAVABlAHgAdABCAG8AZAB5AFwAIgAsAFwAIgB2AGEAbAB1AGUAXAAiADoAewBcACIAawBlAHkAXAAiADoAXAAiAFwAIgAsAFwAIgB2AGEAbAB1AGUAXAAiADoAXAAiAFwAIgB9AH0AXQAiAH0AAABKBAAAewAiAFgAcgBtAEEAYwB0AGkAdgBpAHQAeQBTAHQAcgBlAGEAbQBTAG8AdQByAGMAZQBVAHMAZQByACIAOgAiADkAYwA4AGYAYgBkADAANAAtADQAMwBjADUALQA0ADYANAA2AC0AYgBlADcAMQAtADUAOAAzAGIAMwAwADUAZAA2AGUAYgA5ACIALAAiAEQAaQBzAHAAbABhAHkATgBhAG0AZQAiADoAIgBlAGUAZQAgAGUAZQBlACIALAAiAFgAcgBtAEEAYwB0AGkAdgBpAHQAeQBDAGwAaQBlAG4AdABJAG4AcwB0AHIAdQBtAGUAbgB0AGEAdABpAG8AbgBDAGwAaQBlAG4AdABTAGUAcwBzAGkAbwBuAEkAZAAiADoAIgBOAFwALwBBACIALAAiAFgAcgBtAEEAYwB0AGkAdgBpAHQAeQBTAHQAcgBlAGEAbQBFAHYAZQBuAHQAVABpAG0AZQAiADoAIgA1ADIANAA5ADcAOQA1ADMAMQA3ADcAMgAzADUAMgAzADEANAA3ACIALAAiAFgAcgBtAEEAYwB0AGkAdgBpAHQAeQBTAHQAcgBlAGEAbQBBAGMAdABpAG8AbgBWAGUAcgBiACIAOgAiAEUAZABpAHQAIgAsACIAWAByAG0AQQBjAHQAaQB2AGkAdAB5AFMAdAByAGUAYQBtAFMAdQBiAHQAeQBwAGUAIgA6ACIASQBQAE0ALgBDAG8AbgB0AGEAYwB0ACIALAAiAFgAcgBtAEEAYwB0AGkAdgBpAHQAeQBTAHQAcgBlAGEAbQBUAGEAcgBnAGUAdABFAG4AdABpAHQAaQBlAHMAIgA6ACIAWwBcACIANwA2AGEAMwA0AGIANAA0AC0ANwBkADUAMwAtADQAZQBiAGUALQA5ADcAMwBhAC0AMgA0ADEAMAA3ADAAMQBhADEANwBhADAAXAAiAF0AIgAsACIAWAByAG0AQQBjAHQAaQB2AGkAdAB5AFMAdAByAGUAYQBtAFYAaQBzAGkAYgBpAGwAaQB0AHkATABlAHYAZQBsACIAOgAiADEAIgAsACIAWAByAG0AQQBjAHQAaQB2AGkAdAB5AFMAdAByAGUAYQBtAE0AbwBkAGkAZgBpAGUAZABQAHIAbwBwAGUAcgB0AGkAZQBzACIAOgAiAFsAewBcACIAawBlAHkAXAAiADoAXAAiAEUAbQBhAGkAbAAyAE8AcgBpAGcAaQBuAGEAbABEAGkAcwBwAGwAYQB5AE4AYQBtAGUAXAAiACwAXAAiAHYAYQBsAHUAZQBcACIAOgB7AFwAIgBrAGUAeQBcACIAOgBcACIAXAAiACwAXAAiAHYAYQBsAHUAZQBcACIAOgBcACIAQQBkAGUAbABlAFYAQABzADIAMgBmAGIALgBvAG4AbQBpAGMAcgBvAHMAbwBmAHQALgBjAG8AbQBcACIAfQB9AF0AIgB9AAAA8AMAAHsAIgBYAHIAbQBBAGMAdABpAHYAaQB0AHkAUwB0AHIAZQBhAG0AUwBvAHUAcgBjAGUAVQBzAGUAcgAiADoAIgA5AGMAOABmAGIAZAAwADQALQA0ADMAYwA1AC0ANAA2ADQANgAtAGIAZQA3ADEALQA1ADgAMwBiADMAMAA1AGQANgBlAGIAOQAiACwAIgBEAGkAcwBwAGwAYQB5AE4AYQBtAGUAIgA6ACIAZQBlAGUAIABlAGUAZQAiACwAIgBYAHIAbQBBAGMAdABpAHYAaQB0AHkAQwBsAGkAZQBuAHQASQBuAHMAdAByAHUAbQBlAG4AdABhAHQAaQBvAG4AQwBsAGkAZQBuAHQAUwBlAHMAcwBpAG8AbgBJAGQAIgA6ACIATgBcAC8AQQAiACwAIgBYAHIAbQBBAGMAdABpAHYAaQB0AHkAUwB0AHIAZQBhAG0ARQB2AGUAbgB0AFQAaQBtAGUAIgA6ACIANQAyADQAOQA3ADkANQAzADEANwA3ADMANQAyADMAMAA2ADkAMAAiACwAIgBYAHIAbQBBAGMAdABpAHYAaQB0AHkAUwB0AHIAZQBhAG0AQQBjAHQAaQBvAG4AVgBlAHIAYgAiADoAIgBFAGQAaQB0ACIALAAiAFgAcgBtAEEAYwB0AGkAdgBpAHQAeQBTAHQAcgBlAGEAbQBTAHUAYgB0AHkAcABlACIAOgAiAEkAUABNAC4AQwBvAG4AdABhAGMAdAAiACwAIgBYAHIAbQBBAGMAdABpAHYAaQB0AHkAUwB0AHIAZQBhAG0AVABhAHIAZwBlAHQARQBuAHQAaQB0AGkAZQBzACIAOgAiAFsAXAAiADcANgBhADMANABiADQANAAtADcAZAA1ADMALQA0AGUAYgBlAC0AOQA3ADMAYQAtADIANAAxADAANwAwADEAYQAxADcAYQAwAFwAIgBdACIALAAiAFgAcgBtAEEAYwB0AGkAdgBpAHQAeQBTAHQAcgBlAGEAbQBWAGkAcwBpAGIAaQBsAGkAdAB5AEwAZQB2AGUAbAAiADoAIgAxACIALAAiAFgAcgBtAEEAYwB0AGkAdgBpAHQAeQBTAHQAcgBlAGEAbQBNAG8AZABpAGYAaQBlAGQAUAByAG8AcABlAHIAdABpAGUAcwAiADoAIgBbAHsAXAAiAGsAZQB5AFwAIgA6AFwAIgBUAGUAeAB0AEIAbwBkAHkAXAAiACwAXAAiAHYAYQBsAHUAZQBcACIAOgB7AFwAIgBrAGUAeQBcACIAOgBcACIAXAAiACwAXAAiAHYAYQBsAHUAZQBcACIAOgBcACIAXAAiAH0AfQBdACIAfQAAAEoEAAB7ACIAWAByAG0AQQBjAHQAaQB2AGkAdAB5AFMAdAByAGUAYQBtAFMAbwB1AHIAYwBlAFUAcwBlAHIAIgA6ACIAOQBjADgAZgBiAGQAMAA0AC0ANAAzAGMANQAtADQANgA0ADYALQBiAGUANwAxAC0ANQA4ADMAYgAzADAANQBkADYAZQBiADkAIgAsACIARABpAHMAcABsAGEAeQBOAGEAbQBlACIAOgAiAGUAZQBlACAAZQBlAGUAIgAsACIAWAByAG0AQQBjAHQAaQB2AGkAdAB5AEMAbABpAGUAbgB0AEkAbgBzAHQAcgB1AG0AZQBuAHQAYQB0AGkAbwBuAEMAbABpAGUAbgB0AFMAZQBzAHMAaQBvAG4ASQBkACIAOgAiAE4AXAAvAEEAIgAsACIAWAByAG0AQQBjAHQAaQB2AGkAdAB5AFMAdAByAGUAYQBtAEUAdgBlAG4AdABUAGkAbQBlACIAOgAiADUAMgA0ADkANwA5ADUAMwAxADcANwA0ADQAOQAyADgANQAxADAAIgAsACIAWAByAG0AQQBjAHQAaQB2AGkAdAB5AFMAdAByAGUAYQBtAEEAYwB0AGkAbwBuAFYAZQByAGIAIgA6ACIARQBkAGkAdAAiACwAIgBYAHIAbQBBAGMAdABpAHYAaQB0AHkAUwB0AHIAZQBhAG0AUwB1AGIAdAB5AHAAZQAiADoAIgBJAFAATQAuAEMAbwBuAHQAYQBjAHQAIgAsACIAWAByAG0AQQBjAHQAaQB2AGkAdAB5AFMAdAByAGUAYQBtAFQAYQByAGcAZQB0AEUAbgB0AGkAdABpAGUAcwAiADoAIgBbAFwAIgA3ADYAYQAzADQAYgA0ADQALQA3AGQANQAzAC0ANABlAGIAZQAtADkANwAzAGEALQAyADQAMQAwADcAMAAxAGEAMQA3AGEAMABcACIAXQAiACwAIgBYAHIAbQBBAGMAdABpAHYAaQB0AHkAUwB0AHIAZQBhAG0AVgBpAHMAaQBiAGkAbABpAHQAeQBMAGUAdgBlAGwAIgA6ACIAMQAiACwAIgBYAHIAbQBBAGMAdABpAHYAaQB0AHkAUwB0AHIAZQBhAG0ATQBvAGQAaQBmAGkAZQBkAFAAcgBvAHAAZQByAHQAaQBlAHMAIgA6ACIAWwB7AFwAIgBrAGUAeQBcACIAOgBcACIARQBtAGEAaQBsADMATwByAGkAZwBpAG4AYQBsAEQAaQBzAHAAbABhAHkATgBhAG0AZQBcACIALABcACIAdgBhAGwAdQBlAFwAIgA6AHsAXAAiAGsAZQB5AFwAIgA6AFwAIgBcACIALABcACIAdgBhAGwAdQBlAFwAIgA6AFwAIgBBAGQAZQBsAGUAVgBAAHMAMgAyAGYAYgAuAG8AbgBtAGkAYwByAG8AcwBvAGYAdAAuAGMAbwBtAFwAIgB9AH0AXQAiAH0AAADwAwAAewAiAFgAcgBtAEEAYwB0AGkAdgBpAHQAeQBTAHQAcgBlAGEAbQBTAG8AdQByAGMAZQBVAHMAZQByACIAOgAiADkAYwA4AGYAYgBkADAANAAtADQAMwBjADUALQA0ADYANAA2AC0AYgBlADcAMQAtADUAOAAzAGIAMwAwADUAZAA2AGUAYgA5ACIALAAiAEQAaQBzAHAAbABhAHkATgBhAG0AZQAiADoAIgBlAGUAZQAgAGUAZQBlACIALAAiAFgAcgBtAEEAYwB0AGkAdgBpAHQAeQBDAGwAaQBlAG4AdABJAG4AcwB0AHIAdQBtAGUAbgB0AGEAdABpAG8AbgBDAGwAaQBlAG4AdABTAGUAcwBzAGkAbwBuAEkAZAAiADoAIgBOAFwALwBBACIALAAiAFgAcgBtAEEAYwB0AGkAdgBpAHQAeQBTAHQAcgBlAGEAbQBFAHYAZQBuAHQAVABpAG0AZQAiADoAIgA1ADIANAA5ADcAOQA1ADgAOQA4ADQAMgAxADEAMQA5ADkAMwA1ACIALAAiAFgAcgBtAEEAYwB0AGkAdgBpAHQAeQBTAHQAcgBlAGEAbQBBAGMAdABpAG8AbgBWAGUAcgBiACIAOgAiAEUAZABpAHQAIgAsACIAWAByAG0AQQBjAHQAaQB2AGkAdAB5AFMAdAByAGUAYQBtAFMAdQBiAHQAeQBwAGUAIgA6ACIASQBQAE0ALgBDAG8AbgB0AGEAYwB0ACIALAAiAFgAcgBtAEEAYwB0AGkAdgBpAHQAeQBTAHQAcgBlAGEAbQBUAGEAcgBnAGUAdABFAG4AdABpAHQAaQBlAHMAIgA6ACIAWwBcACIANwA2AGEAMwA0AGIANAA0AC0ANwBkADUAMwAtADQAZQBiAGUALQA5ADcAMwBhAC0AMgA0ADEAMAA3ADAAMQBhADEANwBhADAAXAAiAF0AIgAsACIAWAByAG0AQQBjAHQAaQB2AGkAdAB5AFMAdAByAGUAYQBtAFYAaQBzAGkAYgBpAGwAaQB0AHkATABlAHYAZQBsACIAOgAiADEAIgAsACIAWAByAG0AQQBjAHQAaQB2AGkAdAB5AFMAdAByAGUAYQBtAE0AbwBkAGkAZgBpAGUAZABQAHIAbwBwAGUAcgB0AGkAZQBzACIAOgAiAFsAewBcACIAawBlAHkAXAAiADoAXAAiAFQAZQB4AHQAQgBvAGQAeQBcACIALABcACIAdgBhAGwAdQBlAFwAIgA6AHsAXAAiAGsAZQB5AFwAIgA6AFwAIgBcACIALABcACIAdgBhAGwAdQBlAFwAIgA6AFwAIgBcACIAfQB9AF0AIgB9AAAAAgHojAQgBgAAAAAAwAAAAAAAAEYBQQBiAGMAaABQAGUAcgBzAG8AbgBTAHQAbwByAGUASQBkAAAAMAAAAC4AAAAAHYQDEapmEc2byACqAC/EWg0Aq69yJ6ZuI0uT2LXVY8P/gQAAisvEFgAAPbCEABACAAAAAAADABZADQASDgMAFkANABMO</m:Data>
    }





    public static void initClient(String mailbox) throws Exception {
        testOuth testOuth = new testOuth();
        //soapClient = testOuth.getExchangeOnlineSoapClient();
        ewsClient  = testOuth.getExchangeOnlineEwsClient(mailbox);
        graphClient = testOuth.getGraphClient();
    }


    /**
     * 增量获取用户
     * @return
     */
    public static String syncGetUserInfo(){
        String skipToken = "";
        String userDeltaToken = "";
        UserRequests userRequests = new UserRequests(graphClient);

        return userRequests.syncUserInfo(userDeltaToken, skipToken);
    }


    /**
     * 增量获取用户组
     * @return
     */
    public static String syncGetGroupInfo(){
        String skipToken = "";
        String userDeltaToken = "";
        UserRequests userRequests = new UserRequests(graphClient);

        return userRequests.syncGroupInfo(userDeltaToken, skipToken);
    }


    /**
     * 获取所有的顶级目录
     * @return
     * @throws Exception
     */
    public static String getAllTypeRootFolder() throws Exception {
        FolderRequests folderRequests = new FolderRequests(ewsClient);

        return folderRequests.getAllTypeRootFolder();
    }


    public static List<String> getAzureADInfo(){
        ApplicationRequests applicationRequests = new ApplicationRequests(graphClient);

        return applicationRequests.getAzureADAppAuthResourceAccess("75858a99-700e-4100-aa5c-11fbdcb82f22");
    }


    /**
     * 增量获取子目录
     * @param rootFolderId
     * @param userId
     * @param deltaLink
     * @param skipToken
     * @return
     * @throws Exception
     */
    public static String syncGetMailChildFolder(String rootFolderId, String userId, String deltaLink, String skipToken) throws Exception {
        MessageRequests messageRequests = new MessageRequests(graphClient, userId);
        return messageRequests.syncGetMailFolder(rootFolderId, deltaLink, skipToken);
    }


    /**
     * 普通获取子目录
     * @param rootFolderId
     * @param userId
     * @return
     * @throws Exception
     */
    public static String getMailChildFolder(String rootFolderId, String userId) throws Exception {
        MessageRequests messageRequests = new MessageRequests(graphClient, userId);
        return messageRequests.getMailChildFolder(rootFolderId);
    }


    public static String syncGetMessageInfo(String folderId, String userId, String deltaLink, String skipToken){
        MessageRequests messageRequests = new MessageRequests(graphClient, userId);
        return messageRequests.syncGetMessageInfo(folderId, deltaLink, skipToken, 10);
    }


}
